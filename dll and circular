#include <stdio.h>
#include <stdlib.h>

typedef struct Node
{
    int data;
    struct Node *next;
    struct Node *prev;
} Node;

Node *createNode(int info)
{
    Node *newNode = (Node *)malloc(sizeof(Node));
    newNode->data = info;
    newNode->next = NULL;
    newNode->prev = NULL;
    return newNode;
}
Node *insert_at_front(Node *head, int info)
{
    Node *newNode = createNode(info);
    newNode->next = head;
    if(head!=NULL){
        head->prev = newNode;
    }
    head = newNode;
    return head;
}
Node *insert_at_end(Node *head, int info)
{
    Node *newNode = createNode(info);
    if (head == NULL)
    {
        return newNode;
    }
    else
    {
        Node *ptr = head;
        while (ptr->next != NULL)
        {
            ptr = ptr->next;
        }
        ptr->next = newNode;
        newNode->prev = ptr;
    }
    return head;
}
Node *insertafter_specificNode(Node *head, int key, int info)
{
    Node *newNode = createNode(info);
    Node *ptr = head;
    while (ptr != NULL && ptr->data != key)
    {
        ptr = ptr->next;
    }
    if (ptr == NULL)
    {
        printf("the key=%d is not found in list", key);
    }
    else
    {
        newNode->next = ptr->next;
        newNode->prev = ptr;
        if(ptr->next!=NULL){
            ptr->next->prev = newNode;
        }
        ptr->next = newNode;
    }
    return head;
}
Node *delete_at_begining(Node *head)
{
    if (head == NULL)
    {
        printf("list empty");
        return head;
    }
    else
    {
        Node *ptr = head;
        head = head->next;
        if(head!=NULL){
            head->prev = NULL;
        }
        free(ptr);
        printf("Node deleted from the begining");
        return head;
    }
}
Node *delete_at_end(Node *head)
{
    if (head == NULL)
    {
        printf("list empty");
        return head;
    }

    if (head->next == NULL)
    {
        free(head);
        head = NULL;
        printf("Node deleted from end");
        return NULL;
    }
    Node *ptr = head;
    while (ptr->next != NULL)
    {
        
        ptr = ptr->next;
    }
    ptr->prev->next = NULL;
    free(ptr);
    printf("Node deleted from the end\n");
    return head;
}
Node *delete_after_specificNode(Node *head, int key)
{
    if (head == NULL)
    {
        printf("list empty");
        return head;
    }
    Node *ptr = head,*prev=NULL;

    while (ptr != NULL && ptr->data != key)
    {
        ptr = ptr->next;
    }
    if (ptr == NULL)
    {
        printf("the key=%d is not found in list", key);
    }
    if(ptr==head){
        head = head->next;
        if (head != NULL)
        {
            head->prev = NULL;
        }
        free(ptr);
        printf("Node deleted from the begining");
        return head;
    }
    
        if(ptr->next!=NULL){
        prev->next->prev = ptr->prev;
        }
        ptr->prev->next = ptr->next;
        free(ptr);
        printf("node deleted with key=%d\n", key);
    
    return head;
}
void printList(Node *head)
{
    Node *temp = head;
    if (temp == NULL)
    {
        printf("empty list");
    }
    else{
        printf("NULL<->");

        while (temp != NULL)
        {
            printf("%d<->", temp->data);
            temp = temp->next;
    }
    printf("NULL\n");
    }
}
/*void printList(Node *head){
    if (head == NULL) {
        return;
    }
    else{
        printList(head->next);
        printf("%d->",head->data);
        }
        //printf("NULL\n");
        }*/
int main()
{
    Node *head = NULL;
    int choice, key, value;
    printf("\t \t \t Menu \t \t \t \n \n1.CREATION\n2.DISPLAY\n3.INSERT AT THE BEGINING\n4.INSERT AT THE END \n5.INSERT AFTER SPECIFIC NODE\n6.DELETE AT THE START\n7.DELETE AT THE END\n8.DELETE A SPECIFIC NODE\n9.EXIT\n");

    do
    {
        printf("Enter your choice(1-9):");
        scanf("%d", &choice);

        switch (choice)
        {
        case 1:
            printf("Enter data of node to be inserted");
            scanf("%d", &value);
            head = createNode(value);
            break;
        case 2:
            printList(head);
            break;
        case 3:
            printf("Enter data of node to be inserted");
            scanf("%d", &value);
            head = insert_at_front(head, value);
            break;
        case 4:
            printf("Enter data of node to be inserted");
            scanf("%d", &value);
            head = insert_at_end(head, value);
            break;
        case 5:
            printf("Enter the key after which the node is inserted");
            scanf("%d", &key);
            printf("Enter data of node to be inserted");
            scanf("%d", &value);
            head = insertafter_specificNode(head, key, value);
            break;
        case 6:

            head = delete_at_begining(head);
            break;
        case 7:

            head = delete_at_end(head);
            break;
        case 8:
            printf("Enter the key where the node be deleted");
            scanf("%d", &key);
            head = delete_after_specificNode(head, key);
            break;
        case 9:
            printf("Exiting Program.....");
            break;
        default:
            printf("Invalid choice entered.");
            break;
        }
    } while (choice != 9);
    return 0;
}







Circular 
  #include <stdio.h>
#include <stdlib.h>

// Definition of a Node for Circular Single Linked List
typedef struct Node
{
    int data;
    struct Node *next;
} Node;

// Function to create a new node
Node *createNode(int info)
{
    Node *newNode = (Node *)malloc(sizeof(Node));
    newNode->data = info;
    newNode->next = newNode; // For a single node, it points to itself, making it circular
    return newNode;
}

// Function to insert a node at the end of a circular linked list
Node *insert_at_end(Node *head, int info)
{
    Node *newNode = createNode(info);
    if (head == NULL)
    {
        return newNode; // New node is the only node in the list, pointing to itself
    }

    // Find the last node
    Node *last = head;
    while (last->next != head)
    {
        last = last->next;
    }
    // Insert new node at the end
    last->next = newNode;
    newNode->next = head; // Make it circular
    return head;
}

// Function to delete a specific node in a circular linked list
Node *delete_specificNode(Node *head, int key)
{
    if (head == NULL)
    {
        printf("List is empty\n");
        return NULL;
    }

    Node *current = head, *prev = NULL;

    // Check if the node to delete is the head node
    if (head->data == key)
    {
        // Special case: single node in the list
        if (head->next == head)
        {
            free(head);
            printf("Node with key %d deleted (head node, only node in list)\n", key);
            return NULL;
        }
        // Find the last node to update its next pointer
        Node *last = head;
        while (last->next != head)
        {
            last = last->next;
        }
        last->next = head->next; // Update last node's next
        head = head->next;       // Move head to the next node
        free(current);
        printf("Node with key %d deleted (head node)\n", key);
        return head;
    }

    // Traverse the list to find the node to delete
    do
    {
        prev = current;
        current = current->next;
    } while (current != head && current->data != key);

    // If the node was not found
    if (current == head)
    {
        printf("Node with key %d not found in the list\n", key);
        return head;
    }

    // Delete the node by adjusting pointers
    prev->next = current->next;
    free(current);
    printf("Node with key %d deleted\n", key);
    return head;
}

// Function to print the elements of a circular linked list
void printList(Node *head)
{
    if (head == NULL)
    {
        printf("Empty list\n");
        return;
    }

    Node *temp = head;
    do
    {
        printf("%d -> ", temp->data);
        temp = temp->next;
    } while (temp != head);

    printf("(back to head)\n");
}

// Main function to demonstrate the circular linked list operations
int main()
{
    Node *head = NULL;
    int choice, key, value;

    printf("\t \t \t Menu \t \t \t \n\n");
    printf("1. CREATION\n");
    printf("2. DISPLAY\n");
    printf("3. INSERT AT THE END\n");
    printf("4. DELETE SPECIFIC NODE\n");
    printf("5. EXIT\n");

    do
    {
        printf("Enter your choice (1-5): ");
        scanf("%d", &choice);

        switch (choice)
        {
        case 1:
            printf("Enter data of node to be inserted: ");
            scanf("%d", &value);
            head = insert_at_end(head, value);
            break;
        case 2:
            printList(head);
            break;
        case 3:
            printf("Enter data of node to be inserted: ");
            scanf("%d", &value);
            head = insert_at_end(head, value);
            break;
        case 4:
            printf("Enter the key of the node to be deleted: ");
            scanf("%d", &key);
            head = delete_specificNode(head, key);
            break;
        case 5:
            printf("Exiting Program...\n");
            break;
        default:
            printf("Invalid choice entered.\n");
            break;
        }
    } while (choice != 5);

    return 0;
}


